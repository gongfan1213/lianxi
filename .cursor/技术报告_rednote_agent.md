# 技术报告：rednote_agent.py 小红书爆款文案生成助手

## 1. 项目简介
rednote_agent.py 是一个基于大语言模型（LLM）和工具调用（function call）机制的智能文案生成Agent，专为小红书平台爆款文案自动创作设计。支持调用真实API（如DeepSeek、HKBU等）和本地mock流程，适合内容营销、AI内容创作等场景。

## 2. 主要功能与技术实现
- 支持小红书风格文案的自动生成，输出包含标题、正文、标签、表情符号。
- 采用 ReAct（思考-行动-观察）推理模式，支持多轮工具调用。
- 工具链包括：网页搜索、产品数据库查询、表情符号生成，均可扩展。
- 支持 function call 规范，兼容主流 LLM API。
- 输出支持 Markdown 格式，便于直接发布或二次编辑。

## 3. API与本地mock兼容设计
- 优先使用 requests 方式调用 API，自动读取环境变量 DEEPSEEK_API_KEY 或 fallback 到内置 key（参考模型.md）。
- API不可用或返回异常时，自动切换到本地mock流程，保证功能可用性和演示体验。
- 工具调用流程与 OpenAI/DeepSeek function call 规范兼容，便于后续对接更多模型。

## 4. 典型运行流程与输出示例
- 用户输入产品名和风格，Agent自动多轮调用工具，收集信息、生成文案。
- 运行日志详细展示每一步推理、工具调用、API响应和最终输出。
- 输出示例：
```
## 💦深海蓝藻保湿面膜｜敏感肌救星！一夜回春的补水神器✨

姐妹们！我终于找到了我的本命面膜——深海蓝藻保湿面膜！💧

作为一个常年干燥+敏感肌的人，这款面膜简直就是我的救星！🌊核心成分是深海蓝藻提取物，富含多糖和氨基酸，敷完脸立马水润润的，而且一点都不粘腻！

🌟使用感：
- 精华液超多，敷完还能涂脖子和手臂！
- 质地清爽，敏感肌完全无负担！
- 第二天起床皮肤还是水嫩嫩的，上妆超服帖！

💖适合人群：
- 干燥肌、敏感肌的姐妹必入！
- 熬夜党、换季皮肤不稳定的宝子们！

真的是一夜回春的效果，我已经回购第三次了！姐妹们冲鸭！✨

#敏感肌救星 #深海蓝藻保湿面膜 #补水神器 #护肤必备 #面膜推荐
```

## 5. 常见问题与解决方案
- **API 400错误 'content' is a required property**：需确保所有 assistant/tool 消息都包含 content 字段（即使为空字符串）。
- **JSON解析失败**：多行字符串需用 \n 转义，不能直接物理换行。
- **API不可用**：自动切换mock流程，保证演示和开发不中断。

## 6. 可扩展性与优化建议
- 可扩展更多 function call 工具，如敏感词检测、竞品分析、RAG知识库等。
- 可对接更多 LLM API（如OpenAI、Azure、HKBU等），仅需调整API配置。
- 可结合业务数据（点赞、转化等）持续优化Prompt和工具。
- 支持自动推送结果到内容平台、A/B测试等高级功能。

## 7. 结论
rednote_agent.py 实现了一个高可用、易扩展、兼容多API的小红书爆款文案生成智能Agent。适合内容创作自动化、AI营销、智能写作等多种场景。代码结构清晰，便于二次开发和集成。 